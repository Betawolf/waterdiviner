import re
import sys
import argparse
import logging
import transforms.expander
from urllib.parse import urlparse

top_domains = ['google.com',
'facebook.com',
'youtube.com',
'yahoo.com',
'baidu.com',
'wikipedia.org',
'qq.com',
'linkedin.com',
'live.com',
'amazon.com',
'twitter.com',
'blogspot.com',
'taobao.com',
'google.co.in',
'wordpress.com',
'bing.com',
'yahoo.co.jp',
'yandex.ru',
'sina.com.cn',
'ebay.com',
'vk.com',
'google.de',
'tumblr.com',
'google.co.uk',
'googleusercontent.com',
'pinterest.com',
'msn.com',
'google.fr',
'hao123.com',
'163.com',
'google.com.br',
'google.co.jp',
'mail.ru',
'microsoft.com',
'paypal.com',
'google.com.hk',
'xvideos.com',
'ask.com',
'blogger.com',
'google.ru',
'instagram.com',
'weibo.com',
'craigslist.org',
'imdb.com',
'google.it',
'apple.com',
'google.es',
'tmall.com',
'sohu.com',
'bbc.co.uk',
'xhamster.com',
'soso.com',
'fc2.com',
'amazon.co.jp',
'google.com.mx',
'stackoverflow.com',
't.co',
'360.cn',
'google.ca',
'cnn.com',
'imgur.com',
'go.com',
'conduit.com',
'akamaihd.net',
'alibaba.com',
'flickr.com',
'wordpress.org',
'neobux.com',
'adobe.com',
'odnoklassniki.ru',
'delta-search.com',
'vube.com',
'thepiratebay.sx',
'adcash.com',
'youku.com',
'huffingtonpost.com',
'blogspot.in',
'godaddy.com',
'ifeng.com',
'pornhub.com',
'amazon.de',
'about.com',
'bp.blogspot.com',
'google.com.tr',
'ku6.com',
'ebay.de',
'google.com.au',
'adf.ly',
'uol.com.br',
'ebay.co.uk',
'reddit.com',
'google.pl',
'dailymotion.com',
'netflix.com',
'aol.com',
'livejasmin.com',
'espn.go.com',
'alipay.com',
'babylon.com',
'cnet.com',
'rakuten.co.jp',
'amazon.co.uk',
'youporn.com',
'redtube.com',
'avg.com',
'dailymail.co.uk',
'globo.com',
'sogou.com',
'renren.com',
'xnxx.com',
'vimeo.com',
'booking.com',
'themeforest.net',
'kickass.to',
'indiatimes.com',
'google.com.ar',
'nytimes.com',
'google.nl',
'directrev.com',
'fiverr.com',
'aliexpress.com',
'hootsuite.com',
'google.com.sa',
'slideshare.net',
'ameblo.jp',
'amazonaws.com',
'secureserver.net',
'livedoor.com',
'yelp.com',
'dropbox.com',
'livejournal.com',
'deviantart.com',
'onclickads.net',
'google.com.eg',
'mywebsearch.com',
'aweber.com',
'wikimedia.org',
'mediafire.com',
'jd.com',
'qtrax.com',
'google.com.pk',
'outbrain.com',
'wikia.com',
'weather.com',
'pixnet.net',
'4shared.com',
'etsy.com',
'stumbleupon.com',
'blogfa.com',
'google.co.th',
'google.com.tw',
'media.tumblr.com',
'torrentz.eu',
'mozilla.org',
'badoo.com',
'addthis.com',
'hostgator.com',
'foxnews.com',
'clkmon.com',
'google.co.za',
'archive.org',
'sourceforge.net',
'bankofamerica.com',
'china.com.cn',
'w3schools.com',
'liveinternet.ru',
'statcounter.com',
'theguardian.com',
'forbes.com',
'xinhuanet.com',
'warriorforum.com',
'google.co.id',
'flipkart.com',
'reference.com',
'tripadvisor.com',
'wikihow.com',
'google.co.ve',
'bannersdontwork.com',
'files.wordpress.com',
'tube8.com',
'douban.com',
'chase.com',
'zedo.com',
'wigetmedia.com',
'photobucket.com',
'soundcloud.com',
'yieldmanager.com',
'indeed.com',
'ask.fm',
'salesforce.com',
'walmart.com',
'skype.com',
'nicovideo.jp',
'youjizz.com',
'google.com.co',
'google.com.vn',
'buzzfeed.com',
'spiegel.de',
'goo.ne.jp',
'softonic.com',
'it168.com',
'nbcnews.com',
'people.com.cn',
'allegro.pl',
'google.gr',
'google.be',
'github.com',
'mailchimp.com',
'uploaded.net',
'onet.pl',
'leboncoin.fr',
'tudou.com',
'chinaz.com',
'answers.com',
'amazon.fr',
'google.com.ua',
'bild.de',
'pconline.com.cn',
'telegraph.co.uk',
'pcpop.com',
'google.cn',
'empowernetwork.com',
'zillow.com',
'wellsfargo.com',
'domaintools.com',
'google.com.ng',
'taringa.net',
'mashable.com',
'4dsply.com',
'56.com',
'php.net',
'rutracker.org',
'ehow.com',
'shutterstock.com',
'comcast.net',
'bet365.com',
'google.com.ph',
'wsj.com',
'ikea.com',
'pandora.com',
'thefreedictionary.com',
'google.se',
'wordreference.com',
'ucoz.ru',
'naver.jp',
'espncricinfo.com',
'mercadolivre.com.br',
'google.ro',
'tianya.cn',
'ilivid.com',
'rediff.com',
'so.com',
'rambler.ru',
'weebly.com',
'gmx.net',
'goal.com',
'usatoday.com',
'wix.com',
'kaskus.co.id',
'goodreads.com',
'samsung.com',
'yesky.com',
'58.com',
'hardsextube.com',
'google.com.pe',
'letv.com',
'histats.com',
'popads.net',
'zol.com.cn',
'wp.pl',
'moz.com',
'google.at',
'marca.com',
'ups.com',
'loading-delivery1.com',
'jrj.com.cn',
'extratorrent.com',
'clickbank.com',
'google.dz',
'web.de',
'cnzz.com',
'google.ch',
'reuters.com',
'infusionsoft.com',
'bleacherreport.com',
'stackexchange.com',
'disqus.com',
'imageshack.us',
'free.fr',
'avito.ru',
'siteadvisor.com',
'google.cl',
'putlocker.com',
'pengyou.com',
'scribd.com',
'xyxy.net',
'constantcontact.com',
'washingtonpost.com',
'bitly.com',
'hp.com',
'hudong.com',
'clixsense.com',
'libero.it',
'codecanyon.net',
'xing.com',
'google.pt',
'linkbucks.com',
'likes.com',
'olx.in',
'gsmarena.com',
'naver.com',
'detik.com',
'mobile01.com',
'google.com.sg',
'usps.com',
'iqiyi.com',
'beeg.com',
'pof.com',
'google.com.bd',
'hurriyet.com.tr',
'meetup.com',
'dmm.co.jp',
'ign.com',
'goodgamestudios.com',
'businessinsider.com',
'varzesh3.com',
'milliyet.com.tr',
'optmd.com',
'bluehost.com',
'tinyurl.com',
'orange.fr',
'fedex.com',
'cj.com',
'bestbuy.com',
'qvo6.com',
'thefreecamsecret.com',
'xe.com',
'bloomberg.com',
'motherless.com',
'ig.com.br',
'youm7.com',
'google.com.my',
'4399.com',
'webmd.com',
'joomla.org',
'hulu.com',
'target.com',
'elpais.com',
'mlb.com',
'soku.com',
'xcar.com.cn',
'doubleclick.com',
'odesk.com',
'google.cz',
'in.com',
'clicksor.com',
'webs.com',
'isohunt.com',
'repubblica.it',
'blackhatworld.com',
'ebay.com.au',
'americanexpress.com',
'ndtv.com',
'tmz.com',
'kakaku.com',
'caijing.com.cn',
'ameba.jp',
'twoo.com',
'nih.gov',
'quikr.com',
'groupon.com',
'speedtest.net',
'blogspot.de',
'zippyshare.com',
'55bbs.com',
'twitch.tv',
'ganji.com',
'tagged.com',
'surveymonkey.com',
'w3.org',
'yandex.ua',
'feedly.com',
'techcrunch.com',
'terra.com.br',
't-online.de',
'ebay.it',
'elmundo.es',
'match.com',
'gazeta.pl',
'drudgereport.com',
'trafficunit.in',
'beva.com',
'google.ie',
'dell.com',
'pch.com',
'searchnu.com',
'rapidgator.net',
'naukri.com',
'istockphoto.com',
'aili.com',
'hdfcbank.com',
'amazon.cn',
'uimserv.net',
'ebay.in',
'ning.com',
'google.co.hu',
'freelancer.com',
'snapdo.com',
'google.ae',
'hypergames.net',
'blogspot.fr',
'getresponse.com',
'habrahabr.ru',
'seznam.cz',
'abcnews.go.com',
'jimdo.com',
'xunlei.com',
'myfreecams.com',
'google.no',
'exoclick.com',
'java.com',
'youdao.com',
'kooora.com',
'snapdeal.com',
'pchome.net',
'expedia.com',
'att.com',
'capitalone.com',
'rt.com',
'mercadolibre.com.ar',
'123rf.com',
'chinanews.com',
'quora.com',
'etao.com',
'elance.com',
'goo.gl',
'ck101.com',
'google.dk',
'enet.com.cn',
'sahibinden.com',
'webmoney.ru',
'latimes.com',
'amazon.it',
'm2newmedia.com',
'abril.com.br',
'xda-developers.com',
'9gag.com',
'zendesk.com',
'digg.com',
'list-manage.com',
'google.co.il',
'doorblog.jp',
'icicibank.com',
'drtuber.com',
'autohome.com.cn',
'searchengines.ru',
'microsoftonline.com',
'lenovo.com',
'commentcamarche.net',
'homedepot.com',
'cloudfront.net',
'webcrawler.com',
'probux.com',
'force.com',
'kinopoisk.ru',
'swagbucks.com',
'narod.ru',
'typepad.com',
'pcauto.com.cn',
'csdn.net',
'gutefrage.net',
'hatena.ne.jp',
'retailmenot.com',
'sape.ru',
'vnexpress.net',
'fotolia.com',
'google.az',
'bodybuilding.com',
'backpage.com',
'nfl.com',
'daum.net',
'taleo.net',
'kijiji.ca',
'google.co.kr',
'cntv.cn',
'squidoo.com',
'news.com.au',
'nydailynews.com',
'trulia.com',
'github.io',
'zing.vn',
'chaturbate.com',
'lifehacker.com',
'justdial.com',
'okcupid.com',
'lenta.ru',
'blogspot.ru',
'ad6media.fr',
'corriere.it',
'2345.com',
'majesticseo.com',
'monster.com',
'opensiteexplorer.org',
'ero-advertising.com',
'semrush.com',
'dianping.com',
'time.com',
'foursquare.com',
'amung.us',
'adultfriendfinder.com',
'who.is',
'subscene.com',
'lemonde.fr',
'issuu.com',
'hubspot.com',
'cam4.com',
'accuweather.com',
'chip.de',
'namecheap.com',
'engadget.com',
'kickstarter.com',
'ebay.fr',
'shareasale.com',
'eastmoney.com',
'verizonwireless.com',
'blogspot.jp',
'2ch.net',
'google.fi',
'tabelog.com',
'fbcdn.net',
'yellowpages.com',
'gotomeeting.com',
'cy-pr.com',
'lady8844.com',
'rbc.ru',
'pixiv.net',
'onlylady.com',
'turbobit.net',
'mihanblog.com',
'mercadolibre.com.mx',
'softpedia.com',
'digitalpoint.com',
'seesaa.net',
'pclady.com.cn',
'jqw.com',
'newegg.com',
'website-unavailable.com',
'shaadi.com',
'altervista.org',
'jquery.com',
'sberbank.ru',
'oneindia.in',
'gc.ca',
'nifty.com',
'mp3skull.com',
'hotels.com',
'mobile.de',
'traidnt.net',
'onlinesbi.com',
'soufun.com',
'linkwithin.com',
'iminent.com',
'39.net',
'ancestry.com',
'ya.ru',
'hubpages.com',
'moneycontrol.com',
'jabong.com',
'ezinearticles.com',
'126.com',
'klout.com',
'glispa.com',
'intoday.in',
'over-blog.com',
'transport-preservers.com',
'google.sk',
'51job.com',
'citrixonline.com',
'fatakat.com',
'wiktionary.org',
'ctrip.com',
'search-results.com',
'sakura.ne.jp',
'steampowered.com',
'zimbio.com',
'jobrapido.com',
'acesse.com',
'farsnews.com',
'icbc.com.cn',
'tutsplus.com',
'liveleak.com',
'upworthy.com',
'maktoob.com',
'xgo.com.cn',
'suning.com',
'gmw.cn',
'eazel.com',
'marketwatch.com',
'timeanddate.com',
'battle.net',
'cbsnews.com',
'kompas.com',
'ccb.com',
'rottentomatoes.com',
'houzz.com',
'citibank.com',
'linksynergy.com',
'filestube.com',
'letitbit.net',
'foxsports.com',
'qunar.com',
'oracle.com',
'wetter.com',
'babytree.com',
'ppstream.com',
'tradedoubler.com',
'theblaze.com',
'twimg.com',
'priceline.com',
'spankwire.com',
'gizmodo.com',
'cnbc.com',
'virgilio.it',
'tokobagus.com',
'scoop.it',
'templatemonster.com',
'chexun.com',
'searchfun.in',
'gogetlinks.net',
'streamcloud.eu',
'allrecipes.com',
'amazon.es',
'free-tv-video-online.me',
'filehippo.com',
'ca.gov',
'ovh.net',
'intuit.com',
'mysearchresults.com',
'wunderground.com',
'pr-cy.ru',
'cbssports.com',
'rednet.cn',
'cbslocal.com',
'hidemyass.com',
'babycenter.com',
'biglobe.ne.jp',
'behance.net',
'rutor.org',
'zhaopin.com',
'wretch.cc',
'immobilienscout24.de',
'mynet.com',
'examiner.com',
'bhaskar.com',
'mercadolibre.com.ve',
'gulfup.com',
'feedburner.com',
'disney.go.com',
'lefigaro.fr',
'as.com',
'myspace.com',
'porntube.com',
'slate.com',
'baiducontent.com',
'aizhan.com',
'skysports.com',
'ixxx.com',
'taboola.com',
'lanacion.com.ar',
'mapquest.com',
'coupons.com',
'google.lk',
'gawker.com',
'huanqiu.com',
'zeobit.com',
'dangdang.com',
'10086.cn',
'itau.com.br',
'gamespot.com',
'myntra.com',
'imagebam.com',
'informer.com',
'duowan.com',
'people.com',
'mgid.com',
'pornerbros.com',
'outlook.com',
'peyvandha.ir',
'ce.cn',
'jeuxvideo.com',
'custhelp.com',
'wanggou.com',
'persianblog.ir',
'idnes.cz',
'paipai.com',
'allocine.fr',
'zanox.com',
'cracked.com',
'careerbuilder.com',
'npr.org',
'gogvo.com',
'realtor.com',
'adjuggler.net',
'independent.co.uk',
'sulekha.com',
'lequipe.fr',
'bloglovin.com',
'nuvid.com',
'wired.com',
'eventbrite.com',
'subito.it',
'fucked-tube.com',
'sweetim.com',
'viadeo.com',
'livescore.com',
'sapo.pt',
'vk.me',
'howstuffworks.com',
'agoda.com',
'rightmove.co.uk',
'dict.cc',
'anonym.to',
'duckduckgo.com',
'folha.uol.com.br',
'yoka.com',
'4tube.com',
'888.com',
'trklnks.com',
'tabnak.ir',
'lowes.com',
'alimama.com',
'nypost.com',
'today.com',
'urbandictionary.com',
'macys.com',
'm-w.com',
'eonline.com',
'aljazeera.net',
'nu.nl',
'all-free-download.com',
'incredibar.com',
'bitshare.com',
'jvzoo.com',
'adnxs.com',
'sears.com',
'evernote.com',
'gap.com',
'infolinks.com',
'klikbca.com',
'qidian.com',
'r10.net',
'patch.com',
'haberturk.com',
'leo.org',
'interia.pl',
'google.co.nz',
'vporn.com',
'gamefaqs.com',
'vancl.com',
'tripadvisor.co.uk',
'bannersbroker.com',
'chinabroadcast.cn',
'homeway.com.cn',
'pcgames.com.cn',
'mangareader.net',
'asos.com',
'southwest.com',
'keezmovies.com',
'espnfc.com',
'fhserve.com',
'businessweek.com',
'gstatic.com',
'yihaodian.com',
'google.kz',
'amazon.ca',
'4chan.org',
'focus.de',
'akhbarak.net',
'r7.com',
'clarin.com',
'yixun.com',
'nokia.com',
'haber7.com',
'way2sms.com',
'foodnetwork.com',
'bravotube.net',
'd1110e4.se',
'ibm.com',
'zoho.com',
'glassdoor.com',
'adhitprofits.com',
'gumtree.com',
'mirror.co.uk',
'ucoz.com',
'zilionfast.in',
'okwave.jp',
'dhgate.com',
'correios.com.br',
'yourlust.com',
'magentocommerce.com',
'milanuncios.com',
'ci123.com',
'dmoz.org',
'shopathome.com',
'digikala.com',
'zappos.com',
'bankmellat.ir',
'whitepages.com',
'myegy.com',
'sfgate.com',
'google.bg',
'cnblogs.com',
'weather.com.cn',
'largeporntube.com',
'keepvid.com',
'adultadworld.com',
'dafont.com',
'xtube.com',
'tomshardware.com',
'meituan.com',
'24h.com.vn',
'lollipop-network.com',
'premierleague.com',
'forgeofempires.com',
'adclickxpress.com',
'google.com.kw',
'tradus.com',
'sky.com',
'screencast.com',
'ezpowerads.com',
'kayak.com',
'doublepimp.com',
'dreamstime.com',
'irctc.co.in',
'yomiuri.co.jp',
'pcmag.com',
'adserverplus.com',
'verizon.com',
'nordstrom.com',
'slickdeals.net',
'secure-portal.co',
'adbooth.net',
'yxlady.com',
'searchengineland.com',
'miniclip.com',
'marktplaats.nl',
'hespress.com',
'manta.com',
'vice.com',
'google.com.ec',
'mixi.jp',
'sporx.com',
'indiegogo.com',
'kimiss.com',
'alarabiya.net',
'hongkiat.com',
'noaa.gov',
'usmagazine.com',
'webhostingtalk.com',
'skyrock.com',
'easyhits4u.com',
'stockstar.com',
'leagueoflegends.com',
'telegraaf.nl',
'cloob.com',
'yandex.com.tr',
'dx.com',
'pantip.com',
'so-net.ne.jp',
'welt.de',
'wmmail.ru',
'infobae.com',
'deezer.com',
'video-one.com',
'cheezburger.com',
'barnesandnoble.com',
'friv.com',
'fanpop.com',
'addmefast.com',
'51.la',
'google.com.do',
'novinky.cz',
'amazon.in',
'mpnrs.com',
'biblegateway.com',
'bbc.com',
'hupu.com',
'nationalgeographic.com',
'vipshop.com',
'azlyrics.com',
'pornhublive.com',
'blogspot.com.au',
'overstock.com',
'plugrush.com',
'livedoor.biz',
'coccoc.com',
'elegantthemes.com',
'yaolan.com',
'google.com.qa',
'perezhilton.com',
'kioskea.net',
'panet.co.il',
'prestashop.com',
'cocolog-nifty.com',
'nairaland.com',
'chinabyte.com',
'staples.com',
'tinypic.com',
'statscrop.com',
'sitesell.com',
'weheartit.com',
'gamer.com.tw',
'shopclues.com',
'brainyquote.com',
'imagevenue.com',
'noyapps.com',
'wmtransfer.com',
'yandex.kz',
'youtube-mp3.org',
'woorank.com',
'exblog.jp',
'basecamp.com',
'aftonbladet.se',
'graphicriver.net',
'7k7k.com',
'mysql.com',
'kaixin001.com',
'ellechina.com',
'sfr.fr',
'zazzle.com',
'cafemom.com',
'dantri.com.vn',
'rapidshare.com',
'facenama.com',
'flippa.com',
'heise.de',
'xbox.com',
'ocn.ne.jp',
'viva.co.id',
'united.com',
'payoneer.com',
'grooveshark.com',
'gismeteo.ru',
'ahrefs.com',
'caixa.gov.br',
'cmbchina.com',
'europa.eu',
'bestblackhatforum.com',
'chron.com',
'ria.ru',
'movie4k.to',
'logmein.com',
'xhamstercams.com',
'avast.com',
'forexfactory.com',
'airtel.in',
'nike.com',
'mega.co.nz',
'craigslist.ca',
'elwatannews.com',
'indianrail.gov.in',
'inbox.com',
'last.fm',
'change.org',
'mayoclinic.com',
'mtv.com',
'kdnet.net',
'icicibank.co.in',
'ovh.com',
'315che.com',
'gtmetrix.com',
'buscape.com.br',
'rayli.com.cn',
'zwaar.net',
'wetransfer.com',
'pinshan.com',
'kicker.de',
'woothemes.com',
'pixlr.com',
'tenpay.com',
'pingdom.com',
'clickbank.net',
'viooz.co',
'sendspace.com',
'delta.com',
'makemytrip.com',
'lumosity.com',
'xiaomi.com',
'box.com',
'excite.co.jp',
'netlog.com',
'1und1.de',
'thechive.com',
'homeshop18.com',
'h2porn.com',
'youth.cn',
'delicious.com',
'6.cn',
'kohls.com',
'imagefap.com']

url_regex = re.compile("https?://[^ \n\r\t]+")

class WaterDiviner:
  

  def __init__(self, skipdomains=[], expand=False):
    """ Set guiding parameters.
  
    :param list skipdomains: A list of strs which are domains not to include in the output.
    :param Boolean expand: Whether or not URLs shortened by redirect services should be expanded. (slows down parsing). """
    self.skipdomains = top_domains + skipdomains
    self.watering_holes = {}
    self.expander = None
    if expand:
      self.expander = transforms.expander.URLExpander()


  def _shouldskip(self,domain):
      if domain in self.skipdomains:
        return True
      else:
        for sd in self.skipdomains:
          if sd in domain:
            return True
      return False


  def parse(self,text):
    """ Process the input text, building up a count
    of any allowed domains. 
  
    :param str text: Any text, but only that with URLs in it changes the state. """
    urls = url_regex.findall(text)
    if self.expander: 
      urls = self.expander.transform_all(urls)
    domains = [urlparse(url).netloc for url in urls]
    for domain in domains:
      if domain in self.watering_holes:
        self.watering_holes[domain] += 1
      else:
        self.watering_holes[domain] = 1
      

  def get_best(self, n=5):
    """ Get the best results from the diviner.
    
    :param int n: The (maximum) number of results to retrieve. 
    :return: A list of n or more items, each being a (domain, count) tuple."""
    ret = []
    i = 0
    for wh in sorted(self.watering_holes, key=self.watering_holes.get, reverse=True):
      if self._shouldskip(wh):
        logging.info("Omitting {}".format(wh))
        continue
      ret.append(tuple([wh,self.watering_holes[wh]]))
      i += 1 
      if i == n:
        break
    return ret


if __name__ == '__main__':
  parser = argparse.ArgumentParser(description="Pull out domains to target for attacks from a body of text.")
  parser.add_argument('infiles',nargs='+', help='The input files. Default is STDIN.',default=sys.stdin,type=argparse.FileType('r'))
  parser.add_argument('--outfile','-o',nargs='?', help='Writeable output file. Default is STDOUT. ',default=sys.stdout,type=argparse.FileType('w'))
  parser.add_argument('--errors', '-r',nargs='?',help='Logfile for warnings. Default is STDERR.',default=sys.stderr)
  parser.add_argument('--exclude','-x', help='A domain to exclude from consideration.')
  parser.add_argument('--expand','-p', dest='expand', help='Include this flag to expand shortened URLs (slow).',action='store_true')
  parser.add_argument('--verbose','-v', dest='verbose', help='Increase verbosity level.',action='store_true')
  parser.add_argument('--num','-n',nargs='?', help='The number of ranks down the watering hole list to report.',type=int, default=5)
  parser.set_defaults(expand=False,verbose=False)
  args = parser.parse_args()  

  #Logging configuration
  loglevel = logging.WARN
  if args.verbose:
    loglevel = logging.INFO
  if args.errors != sys.stderr:
    logging.basicConfig(filename=args.errors,level=loglevel)
  else:
    logging.basicConfig(level=loglevel)

  #Initialise diviner
  if args.exclude:
    wd = WaterDiviner(args.exclude,expand=args.expand)
  else:
    wd = WaterDiviner(expand=args.expand)

  #Parse input files
  for infile in args.infiles:
    for line in infile:
      wd.parse(line)

  #Write output (domain:count).
  for domain, count in wd.get_best(args.num):
    args.outfile.write("{}:{}\n".format(domain,count))

